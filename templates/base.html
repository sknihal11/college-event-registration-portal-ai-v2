{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EventFlow AI | College Event Portal</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,500;1,9..40,300&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">

    <style>
        :root {
            --bg:        #04050f;
            --surface:   #0b0d1e;
            --surface2:  #111328;
            --rim:       #1e2140;
            --rim2:      #2a2f5a;
            --violet:    #7c5cfc;
            --violet-g:  #a87cff;
            --rose:      #ff4e8e;
            --amber:     #ffb347;
            --sky:       #38d9ff;
            --mint:      #3dffa8;
            --text:      #eef0ff;
            --text2:     #8a90b8;
            --muted:     #4a5080;
            --success:   #22c55e;
            --danger:    #ef4444;
            --warning:   #f59e0b;
            --info:      #38d9ff;
            --r:         14px;
            --r-lg:      22px;
            --card-shadow: 0 8px 32px rgba(0,0,0,0.45);
            --card-shadow-hover: 0 20px 60px rgba(0,0,0,0.6), 0 0 0 1px rgba(124,92,252,0.18);
        }

        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; }

        body {
            font-family: 'DM Sans', sans-serif;
            background: var(--bg);
            color: var(--text);
            font-size: 15px;
            line-height: 1.65;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* ══════════════════════════════════
           ENVIRONMENT
        ══════════════════════════════════ */
        .env-starfield {
            position: fixed; inset: 0; z-index: 0; pointer-events: none;
            background:
                radial-gradient(1px 1px at 10% 20%, rgba(255,255,255,.65) 0%, transparent 100%),
                radial-gradient(1px 1px at 30% 55%, rgba(255,255,255,.40) 0%, transparent 100%),
                radial-gradient(1.5px 1.5px at 55% 10%, rgba(255,255,255,.70) 0%, transparent 100%),
                radial-gradient(1px 1px at 70% 80%, rgba(255,255,255,.50) 0%, transparent 100%),
                radial-gradient(1px 1px at 85% 40%, rgba(255,255,255,.40) 0%, transparent 100%),
                radial-gradient(2px 2px at 15% 75%, rgba(255,255,255,.30) 0%, transparent 100%),
                radial-gradient(1px 1px at 92% 15%, rgba(255,255,255,.60) 0%, transparent 100%),
                radial-gradient(1.5px 1.5px at 42% 90%, rgba(255,255,255,.35) 0%, transparent 100%),
                radial-gradient(1px 1px at 60% 65%, rgba(255,255,255,.50) 0%, transparent 100%),
                radial-gradient(1px 1px at 78% 30%, rgba(255,255,255,.40) 0%, transparent 100%),
                radial-gradient(1px 1px at 25% 45%, rgba(255,255,255,.30) 0%, transparent 100%),
                radial-gradient(2px 2px at 5% 90%, rgba(255,255,255,.20) 0%, transparent 100%),
                radial-gradient(1px 1px at 50% 50%, rgba(255,255,255,.50) 0%, transparent 100%),
                radial-gradient(1.5px 1.5px at 95% 70%, rgba(255,255,255,.40) 0%, transparent 100%),
                radial-gradient(1px 1px at 38% 25%, rgba(255,255,255,.60) 0%, transparent 100%);
        }

        .env-aurora { position: fixed; inset: 0; z-index: 0; pointer-events: none; overflow: hidden; }
        .aura {
            position: absolute; border-radius: 50%;
            mix-blend-mode: screen; filter: blur(90px);
            animation: auraFloat 20s ease-in-out infinite;
        }
        .aura-1 { width:600px;height:600px; background:radial-gradient(circle,#7c5cfc 0%,transparent 70%); top:-200px;left:-100px; animation-delay:0s;    opacity:.18; }
        .aura-2 { width:500px;height:500px; background:radial-gradient(circle,#ff4e8e 0%,transparent 70%); bottom:-100px;right:-80px; animation-delay:-7s; opacity:.14; }
        .aura-3 { width:400px;height:400px; background:radial-gradient(circle,#38d9ff 0%,transparent 70%); top:40%;left:60%; animation-delay:-14s;           opacity:.12; }
        .aura-4 { width:300px;height:300px; background:radial-gradient(circle,#3dffa8 0%,transparent 70%); top:60%;left:10%; animation-delay:-5s;            opacity:.10; }
        @keyframes auraFloat {
            0%   { transform: translate(0,0) scale(1); }
            33%  { transform: translate(40px,-30px) scale(1.08); }
            66%  { transform: translate(-20px,50px) scale(0.95); }
            100% { transform: translate(0,0) scale(1); }
        }

        .env-particles { position: fixed; inset: 0; z-index: 0; pointer-events: none; overflow: hidden; }
        .particle {
            position: absolute; border-radius: 50%;
            animation: particleRise linear infinite; opacity: 0;
        }
        .particle:nth-child(1)  { width:3px;height:3px;background:var(--violet);   left:10%; animation-duration:12s;animation-delay:0s;    }
        .particle:nth-child(2)  { width:2px;height:2px;background:var(--rose);     left:25%; animation-duration:15s;animation-delay:-4s;   }
        .particle:nth-child(3)  { width:4px;height:4px;background:var(--sky);      left:40%; animation-duration:10s;animation-delay:-8s;   }
        .particle:nth-child(4)  { width:2px;height:2px;background:var(--mint);     left:60%; animation-duration:18s;animation-delay:-2s;   }
        .particle:nth-child(5)  { width:3px;height:3px;background:var(--amber);    left:75%; animation-duration:13s;animation-delay:-6s;   }
        .particle:nth-child(6)  { width:2px;height:2px;background:var(--violet-g); left:88%; animation-duration:16s;animation-delay:-10s;  }
        .particle:nth-child(7)  { width:3px;height:3px;background:var(--sky);      left:5%;  animation-duration:11s;animation-delay:-3s;   }
        .particle:nth-child(8)  { width:2px;height:2px;background:var(--rose);     left:52%; animation-duration:14s;animation-delay:-9s;   }
        .particle:nth-child(9)  { width:4px;height:4px;background:var(--mint);     left:33%; animation-duration:17s;animation-delay:-1s;   }
        .particle:nth-child(10) { width:2px;height:2px;background:var(--amber);    left:70%; animation-duration:9s; animation-delay:-5s;   }
        @keyframes particleRise {
            0%   { transform: translateY(100vh) scale(0); opacity: 0; }
            10%  { opacity: .8; }
            90%  { opacity: .4; }
            100% { transform: translateY(-10vh) scale(1.5); opacity: 0; }
        }

        .env-scanline {
            position: fixed; top:-2px; left:0; right:0; height:2px;
            z-index: 1; pointer-events: none;
            background: linear-gradient(90deg, transparent, var(--violet), var(--sky), var(--mint), transparent);
            opacity: .3; animation: scan 9s linear infinite;
            box-shadow: 0 0 18px var(--violet), 0 0 36px var(--sky);
        }
        @keyframes scan { from{top:-2px;} to{top:100vh;} }

        body::after {
            content: ''; position: fixed; inset: 0; z-index: 0; pointer-events: none;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.035'/%3E%3C/svg%3E");
            background-size: 200px; opacity: .45;
        }

        /* ══════════════════════════════════
           NAVBAR
        ══════════════════════════════════ */
        .navbar-custom {
            position: sticky; top: 0; z-index: 100;
            background: rgba(4, 5, 15, 0.82);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border-bottom: 1px solid var(--rim);
        }
        .navbar-custom .container { padding-top: .9rem; padding-bottom: .9rem; }

        .navbar-brand {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 1.45rem; letter-spacing: .15em;
            color: var(--text) !important;
            text-decoration: none;
            display: flex; align-items: center; gap: .6rem;
        }
        .brand-dot {
            width: 10px; height: 10px; border-radius: 50%;
            background: var(--violet);
            box-shadow: 0 0 0 3px rgba(124,92,252,.25), 0 0 16px var(--violet);
            animation: pulseDot 2s ease infinite;
        }
        @keyframes pulseDot {
            0%,100% { box-shadow: 0 0 0 3px rgba(124,92,252,.25), 0 0 16px var(--violet); }
            50%      { box-shadow: 0 0 0 7px rgba(124,92,252,.08), 0 0 30px var(--violet); }
        }

        .welcome-text {
            font-family: 'JetBrains Mono', monospace;
            font-size: .68rem; letter-spacing: .08em; text-transform: uppercase;
            color: var(--muted);
        }

        /* Nav buttons */
        .btn { border-radius: var(--r); font-family: 'DM Sans', sans-serif; font-weight: 500; border: none; cursor: pointer; text-decoration: none; transition: all .22s ease; display: inline-flex; align-items: center; justify-content: center; }

        .btn-nav-ghost {
            background: transparent; color: var(--text2);
            border: 1px solid var(--rim2); font-size: .8rem;
            padding: .38rem 1rem;
        }
        .btn-nav-ghost:hover { border-color: var(--violet); color: var(--violet-g); }

        .btn-nav-primary {
            background: linear-gradient(135deg, var(--violet), var(--rose));
            color: #fff; font-size: .8rem; padding: .38rem 1rem;
            box-shadow: 0 0 20px rgba(124,92,252,.3);
        }
        .btn-nav-primary:hover { transform: translateY(-1px); box-shadow: 0 4px 30px rgba(124,92,252,.5); color: #fff; }

        .btn-nav-warning {
            background: rgba(255,179,71,.12); color: var(--amber);
            border: 1px solid rgba(255,179,71,.25); font-size: .8rem; padding: .38rem 1rem;
        }
        .btn-nav-warning:hover { background: rgba(255,179,71,.22); }

        .btn-nav-info {
            background: rgba(56,217,255,.1); color: var(--sky);
            border: 1px solid rgba(56,217,255,.22); font-size: .8rem; padding: .38rem 1rem;
        }
        .btn-nav-info:hover { background: rgba(56,217,255,.2); }

        .btn-nav-danger {
            background: rgba(255,78,142,.1); color: var(--rose);
            border: 1px solid rgba(255,78,142,.22); font-size: .8rem; padding: .38rem 1rem;
        }
        .btn-nav-danger:hover { background: rgba(255,78,142,.2); }

        .btn-nav-secondary {
            background: var(--surface2); color: var(--text2);
            border: 1px solid var(--rim2); font-size: .8rem; padding: .38rem 1rem;
        }
        .btn-nav-secondary:hover { border-color: var(--muted); }

        /* ══════════════════════════════════
           GLOBAL CONTENT LAYER
        ══════════════════════════════════ */
        .content-wrap {
            position: relative; z-index: 2;
        }

        .container { max-width: 1200px; }

        /* ══════════════════════════════════
           BOOTSTRAP CARD OVERRIDE
        ══════════════════════════════════ */
        .card {
            background: var(--surface);
            border: 1px solid var(--rim2);
            border-radius: var(--r-lg) !important;
            box-shadow: var(--card-shadow);
            color: var(--text);
            transition: transform .26s ease, box-shadow .26s ease, border-color .26s ease;
        }
        .card:hover {
            transform: translateY(-4px);
            box-shadow: var(--card-shadow-hover);
            border-color: rgba(124,92,252,.4);
        }
        .card.shadow-soft { box-shadow: var(--card-shadow); }
        .card-body { color: var(--text); }

        /* ══════════════════════════════════
           FORMS (global)
        ══════════════════════════════════ */
        form p { margin-bottom: .9rem; }
        form label {
            display: block; font-weight: 500;
            margin-bottom: .35rem; color: var(--text2);
            font-size: .85rem;
        }
        form input, form select, form textarea {
            width: 100%;
            background: var(--surface2);
            border: 1px solid var(--rim2);
            border-radius: var(--r);
            padding: .7rem 1rem;
            color: var(--text);
            font-family: 'DM Sans', sans-serif;
            transition: border .2s, box-shadow .2s;
        }
        form input:focus, form select:focus, form textarea:focus {
            outline: none;
            border-color: var(--violet);
            box-shadow: 0 0 0 3px rgba(124,92,252,.15);
        }
        form input::placeholder, form textarea::placeholder { color: var(--muted); }
        form select option { background: var(--surface2); color: var(--text); }
        form .helptext {
            display: block; font-size: .82rem;
            color: var(--muted); margin-top: .25rem;
        }
        form ul.errorlist {
            list-style: none; padding: 0; margin: 0 0 .4rem;
            color: var(--rose); font-size: .88rem;
        }

        /* ══════════════════════════════════
           ALERTS
        ══════════════════════════════════ */
        .alert {
            border-radius: var(--r) !important;
            border: 1px solid transparent !important;
            font-size: .9rem;
        }
        .alert-success {
            background: rgba(34,197,94,.1) !important;
            border-color: rgba(34,197,94,.25) !important;
            color: #4ade80 !important;
        }
        .alert-danger, .alert-error {
            background: rgba(239,68,68,.1) !important;
            border-color: rgba(239,68,68,.25) !important;
            color: #f87171 !important;
        }
        .alert-warning {
            background: rgba(245,158,11,.1) !important;
            border-color: rgba(245,158,11,.25) !important;
            color: var(--amber) !important;
        }
        .alert-info {
            background: rgba(56,217,255,.08) !important;
            border-color: rgba(56,217,255,.22) !important;
            color: var(--sky) !important;
        }
        .btn-close { filter: invert(1) opacity(.5); }

        /* ══════════════════════════════════
           PROGRESS (bootstrap override)
        ══════════════════════════════════ */
        .progress {
            height: 5px !important;
            border-radius: 999px !important;
            background: var(--rim) !important;
        }
        .progress-bar {
            border-radius: 999px !important;
            background: linear-gradient(90deg, var(--violet), var(--rose)) !important;
        }

        /* ══════════════════════════════════
           BADGES (bootstrap override)
        ══════════════════════════════════ */
        .badge {
            font-family: 'JetBrains Mono', monospace !important;
            font-size: .6rem !important; letter-spacing: .08em;
            border-radius: 6px !important; font-weight: 500 !important;
        }
        .badge-soft {
            background: rgba(124,92,252,.12); color: var(--violet-g);
            border: 1px solid rgba(124,92,252,.22);
        }
        .badge-premium {
            background: rgba(255,179,71,.12); color: var(--amber);
            border: 1px solid rgba(255,179,71,.22);
        }
        .text-bg-primary   { background: rgba(124,92,252,.15) !important; color: var(--violet-g) !important; }
        .text-bg-success   { background: rgba(61,255,168,.12) !important; color: var(--mint)     !important; }
        .text-bg-warning   { background: rgba(255,179,71,.12) !important; color: var(--amber)    !important; }
        .text-bg-danger    { background: rgba(255,78,142,.12) !important; color: var(--rose)     !important; }
        .text-bg-info      { background: rgba(56,217,255,.1)  !important; color: var(--sky)      !important; }
        .text-bg-dark      { background: var(--surface2)      !important; color: var(--text2)    !important; border: 1px solid var(--rim2); }
        .text-bg-light     { background: var(--surface2)      !important; color: var(--text2)    !important; border: 1px solid var(--rim2); }
        .rounded-pill      { border-radius: 999px !important; }

        /* ══════════════════════════════════
           HERO (used in index)
        ══════════════════════════════════ */
        .hero {
            border-radius: var(--r-lg);
            background: linear-gradient(135deg, rgba(17,19,40,.95), rgba(11,13,30,.9));
            border: 1px solid var(--rim2);
            box-shadow: var(--card-shadow);
            position: relative; overflow: hidden;
        }
        .hero::before {
            content: ''; position: absolute; inset: 0;
            background: linear-gradient(135deg, rgba(124,92,252,.12) 0%, rgba(255,78,142,.06) 100%);
            pointer-events: none;
        }

        /* ══════════════════════════════════
           MISC TEXT / UTILITY OVERRIDES
        ══════════════════════════════════ */
        .section-title { font-family: 'Bebas Neue', sans-serif; letter-spacing: .05em; color: var(--text); line-height: 1; }
        .section-subtitle { color: var(--muted); margin-bottom: 0; font-size: .85rem; }
        .text-muted { color: var(--muted) !important; }
        .fw-bold { font-weight: 600 !important; }
        .text-success { color: var(--mint) !important; }
        .text-danger  { color: var(--rose) !important; }
        .text-warning { color: var(--amber) !important; }
        .text-info    { color: var(--sky) !important; }
        h1,h2,h3,h4,h5,h6 { color: var(--text); }

        /* Outline button override */
        .btn-outline-dark {
            background: transparent; color: var(--text2);
            border: 1px solid var(--rim2) !important;
        }
        .btn-outline-dark:hover { background: var(--surface2); color: var(--text); border-color: var(--rim2) !important; }
        .btn-outline-danger {
            background: transparent; color: var(--rose);
            border: 1px solid rgba(255,78,142,.3) !important;
        }
        .btn-outline-danger:disabled { opacity: .45; cursor: not-allowed; }

        /* brand / soft buttons (used in index child) */
        .btn-brand {
            background: linear-gradient(135deg, var(--violet), var(--rose));
            color: #fff !important;
            box-shadow: 0 0 20px rgba(124,92,252,.3);
        }
        .btn-brand:hover { transform: translateY(-2px); box-shadow: 0 4px 35px rgba(124,92,252,.5); color: #fff !important; }
        .btn-soft {
            background: var(--surface2); color: var(--text2);
            border: 1px solid var(--rim2);
        }
        .btn-soft:hover { border-color: var(--violet); color: var(--violet-g); }

        /* ══════════════════════════════════
           FOOTER
        ══════════════════════════════════ */
        .footer { margin-top: 3rem; padding: 1.2rem 0; }
        .foot-card {
            background: var(--surface);
            border: 1px solid var(--rim2);
            border-radius: var(--r-lg);
            padding: 1.2rem 1.4rem;
            position: relative; overflow: hidden;
        }
        .foot-card::before {
            content: ''; position: absolute; top: 0; left: 0; right: 0; height: 1px;
            background: linear-gradient(90deg, transparent, var(--violet), var(--sky), var(--mint), transparent);
        }
        .foot-brand {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 1rem; letter-spacing: .12em; color: var(--text);
        }
        .foot-sub {
            font-family: 'JetBrains Mono', monospace;
            font-size: .65rem; letter-spacing: .1em; color: var(--muted);
            margin-top: .2rem;
        }

        @media (max-width: 768px) {
            .navbar-custom .container { flex-wrap: wrap; gap: .5rem; }
        }
    </style>
</head>
<body>

<!-- ── ENVIRONMENT ── -->
<div class="env-starfield"></div>
<div class="env-aurora">
    <div class="aura aura-1"></div>
    <div class="aura aura-2"></div>
    <div class="aura aura-3"></div>
    <div class="aura aura-4"></div>
</div>
<div class="env-particles">
    <div class="particle"></div><div class="particle"></div><div class="particle"></div>
    <div class="particle"></div><div class="particle"></div><div class="particle"></div>
    <div class="particle"></div><div class="particle"></div><div class="particle"></div>
    <div class="particle"></div>
</div>
<div class="env-scanline"></div>

<!-- ── NAVBAR ── -->
<nav class="navbar-custom">
    <div class="container d-flex align-items-center justify-content-between flex-wrap gap-2">
        <a class="navbar-brand" href="/">
            <span class="brand-dot"></span> EventFlow AI
        </a>

        <div class="d-flex flex-wrap gap-2 align-items-center">
            {% if user.is_authenticated %}
                <span class="welcome-text">{{ user.username }}</span>
                <a class="btn btn-nav-ghost" href="/my-events/">My Events</a>
                {% if user.is_staff %}
                    <a class="btn btn-nav-warning" href="/analytics/">Analytics</a>
                    <a class="btn btn-nav-info" href="/verify-qr/">Verify QR</a>
                    <a class="btn btn-nav-info" href="/export-csv/">Export CSV</a>
                    <a class="btn btn-nav-secondary" href="/admin/">Admin</a>
                {% endif %}
                <a class="btn btn-nav-danger" href="/logout/">Logout</a>
            {% else %}
                <a class="btn btn-nav-ghost" href="/login/">Login</a>
                <a class="btn btn-nav-primary" href="/signup/">Sign Up →</a>
            {% endif %}
        </div>
    </div>
</nav>

<!-- ── CONTENT ── -->
<div class="content-wrap">
    <div class="container mt-4">

        {% if messages %}
            {% for message in messages %}
                <div class="alert alert-{{ message.tags|default:'info' }} alert-dismissible fade show mb-3" role="alert">
                    {{ message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            {% endfor %}
        {% endif %}

        {% block content %}{% endblock %}

        <!-- FOOTER -->
        <div class="footer">
            <div class="foot-card text-center">
                <div class="foot-brand">EventFlow AI</div>
                <div class="foot-sub">AI Recommendations &nbsp;·&nbsp; QR Passes &nbsp;·&nbsp; Analytics &nbsp;·&nbsp; Admin Reporting</div>
            </div>
        </div>

    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>