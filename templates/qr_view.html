{% extends "base.html" %}
{% block content %}

<style>
.qr-wrap {
    max-width: 760px;
    margin: 2.5rem auto;
    animation: fadeUp .65s ease both;
}

.qr-card {
    background: var(--surface);
    border: 1px solid var(--rim2);
    border-radius: var(--r-lg);
    overflow: hidden;
    position: relative;
    box-shadow: 0 24px 60px rgba(0,0,0,.55);
}
.qr-card::before {
    content: '';
    position: absolute; top: 0; left: 0; right: 0; height: 2px;
    background: linear-gradient(90deg, var(--violet), var(--rose), var(--amber), var(--mint));
}
.qr-card::after {
    content: '';
    position: absolute; top: -60px; right: -60px;
    width: 220px; height: 220px; border-radius: 50%;
    background: radial-gradient(circle, rgba(124,92,252,.14) 0%, transparent 70%);
    pointer-events: none;
}
.qr-card-body { padding: 2.5rem 2rem; }
@media (max-width: 576px) { .qr-card-body { padding: 1.8rem 1.2rem; } }

/* ── Header ── */
.qr-header { text-align: center; margin-bottom: 2.2rem; }

.pass-badge {
    display: inline-flex; align-items: center; gap: .45rem;
    font-family: 'JetBrains Mono', monospace;
    font-size: .65rem; letter-spacing: .15em; text-transform: uppercase;
    background: rgba(255,179,71,.1); color: var(--amber);
    border: 1px solid rgba(255,179,71,.25);
    padding: .35rem 1rem; border-radius: 100px;
    margin-bottom: 1rem;
}
.pass-badge-dot {
    width: 6px; height: 6px; border-radius: 50%;
    background: var(--amber); box-shadow: 0 0 8px var(--amber);
    animation: glowAmber 1.6s ease infinite;
}
@keyframes glowAmber {
    0%,100% { box-shadow: 0 0 6px var(--amber); }
    50%      { box-shadow: 0 0 18px var(--amber); }
}

.qr-main-title {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 2.5rem; letter-spacing: .06em;
    color: var(--text); line-height: 1; margin-bottom: .45rem;
}
.qr-subtitle {
    font-family: 'DM Sans', sans-serif;
    font-size: .87rem; color: var(--muted); font-weight: 300;
}

/* ── Body grid ── */
.qr-body-grid {
    display: grid;
    grid-template-columns: auto 1fr;
    gap: 2rem; align-items: start;
}
@media (max-width: 600px) { .qr-body-grid { grid-template-columns: 1fr; } }

/* ── QR Panel ── */
.qr-img-panel {
    background: var(--surface2);
    border: 1px solid var(--rim2);
    border-radius: var(--r-lg);
    padding: 1.2rem;
    display: inline-flex; flex-direction: column;
    align-items: center; gap: .85rem;
    position: relative; overflow: hidden;
}
/* corner ticks */
.qr-img-panel::before,
.qr-img-panel::after {
    content: ''; position: absolute;
    width: 18px; height: 18px;
    border-color: var(--violet); border-style: solid; border-width: 0;
}
.qr-img-panel::before { top: 8px; left: 8px; border-top-width: 2px; border-left-width: 2px; border-radius: 4px 0 0 0; }
.qr-img-panel::after  { bottom: 8px; right: 8px; border-bottom-width: 2px; border-right-width: 2px; border-radius: 0 0 4px 0; }

/* QR code: dark background, invert so it reads violet-on-dark */
.qr-img-inner {
    background: var(--bg);
    border: 1px solid var(--rim2);
    border-radius: 10px;
    padding: .9rem;
    line-height: 0;
    position: relative; overflow: hidden;
}
.qr-img-inner img {
    display: block;
    width: 200px; height: 200px;
    object-fit: contain;
    border-radius: 6px;
    /* invert white→dark, then hue-rotate so modules become violet-tinted */
    filter: invert(1) hue-rotate(220deg) saturate(1.4) brightness(0.92);
}
@media (max-width: 600px) { .qr-img-inner img { width: 170px; height: 170px; } }

.qr-scan-bar {
    width: 100%; height: 2px;
    background: transparent; overflow: hidden; border-radius: 2px; position: relative;
}
.qr-scan-bar::after {
    content: ''; position: absolute; inset: 0;
    background: linear-gradient(90deg, transparent, var(--violet), var(--sky), transparent);
    animation: scanBar 2.2s ease-in-out infinite; opacity: .85;
}
@keyframes scanBar { 0%{transform:translateX(-100%);} 100%{transform:translateX(100%);} }

.qr-scan-label {
    font-family: 'JetBrains Mono', monospace;
    font-size: .6rem; letter-spacing: .14em; text-transform: uppercase;
    color: var(--muted);
}

/* ── Details card ── */
.details-card {
    background: var(--surface2);
    border: 1px solid var(--rim2);
    border-radius: var(--r-lg);
    padding: 1.5rem;
}
.event-name {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 1.65rem; letter-spacing: .04em;
    color: var(--text); line-height: 1.1;
    margin-bottom: 1.2rem;
    padding-bottom: 1rem;
    border-bottom: 1px solid var(--rim);
}
.detail-rows { display: flex; flex-direction: column; gap: .8rem; }
.detail-row { display: flex; justify-content: space-between; align-items: flex-start; gap: 1rem; }
.detail-label {
    font-family: 'JetBrains Mono', monospace;
    font-size: .6rem; letter-spacing: .1em; text-transform: uppercase;
    color: var(--muted); white-space: nowrap; padding-top: .1rem; flex-shrink: 0;
}
.detail-val {
    font-family: 'DM Sans', sans-serif;
    font-size: .875rem; color: var(--text2); text-align: right; font-weight: 400;
}

.status-valid {
    display: inline-flex; align-items: center; gap: .4rem;
    font-family: 'JetBrains Mono', monospace;
    font-size: .65rem; letter-spacing: .1em; text-transform: uppercase;
    background: rgba(61,255,168,.1); color: var(--mint);
    border: 1px solid rgba(61,255,168,.25);
    padding: .25rem .75rem; border-radius: 100px;
}
.status-dot {
    width: 6px; height: 6px; border-radius: 50%;
    background: var(--mint); box-shadow: 0 0 8px var(--mint);
    animation: glowMint 1.5s ease infinite;
}
@keyframes glowMint {
    0%,100% { box-shadow: 0 0 6px var(--mint); }
    50%      { box-shadow: 0 0 18px var(--mint); }
}

/* ── Note ── */
.qr-note {
    margin-top: 1.6rem;
    background: rgba(56,217,255,.07);
    border: 1px solid rgba(56,217,255,.18);
    border-radius: var(--r);
    padding: .9rem 1.1rem;
    display: flex; align-items: flex-start; gap: .65rem;
}
.qr-note-icon { font-size: 1rem; flex-shrink: 0; margin-top: .05rem; color: var(--sky); }
.qr-note-text {
    font-family: 'DM Sans', sans-serif;
    font-size: .83rem; color: var(--sky); font-weight: 300; line-height: 1.55;
}
.qr-note-text strong { font-weight: 600; color: var(--sky); }

/* ── Actions ── */
.qr-actions {
    display: flex; flex-wrap: wrap; gap: .75rem;
    justify-content: center;
    margin-top: 2rem; padding-top: 1.6rem;
    border-top: 1px solid var(--rim);
}
.btn-back {
    font-family: 'DM Sans', sans-serif; font-weight: 500; font-size: .875rem;
    background: var(--surface2); color: var(--text2);
    border: 1px solid var(--rim2);
    padding: .62rem 1.5rem; border-radius: var(--r);
    text-decoration: none; cursor: pointer;
    transition: all .22s ease;
    display: inline-flex; align-items: center; gap: .4rem;
}
.btn-back:hover { border-color: var(--violet); color: var(--violet-g); }

.btn-home {
    font-family: 'DM Sans', sans-serif; font-weight: 500; font-size: .875rem;
    background: linear-gradient(135deg, var(--violet), var(--rose));
    color: #fff; border: none;
    padding: .62rem 1.5rem; border-radius: var(--r);
    text-decoration: none; cursor: pointer;
    box-shadow: 0 0 20px rgba(124,92,252,.3);
    transition: all .22s ease;
    display: inline-flex; align-items: center; gap: .4rem;
}
.btn-home:hover { transform: translateY(-2px); box-shadow: 0 6px 36px rgba(124,92,252,.5); color: #fff; }

@keyframes fadeUp {
    from { opacity: 0; transform: translateY(22px); }
    to   { opacity: 1; transform: translateY(0); }
}
</style>

<div class="qr-wrap">
    <div class="qr-card">
        <div class="qr-card-body">

            <!-- Header -->
            <div class="qr-header">
                <div class="pass-badge">
                    <div class="pass-badge-dot"></div>
                    Verified Entry Pass
                </div>
                <h2 class="qr-main-title">Event QR Pass</h2>
                <p class="qr-subtitle">Present this code at the venue for verification and entry</p>
            </div>

            <!-- Body -->
            <div class="qr-body-grid">

                <!-- QR Image -->
                <div>
                    <div class="qr-img-panel">
                        <div class="qr-img-inner">
                            <img src="data:image/png;base64,{{ qr_base64 }}" alt="QR Code">
                        </div>
                        <div class="qr-scan-bar"></div>
                        <span class="qr-scan-label">Scan to Verify</span>
                    </div>
                </div>

                <!-- Details -->
                <div class="details-card">
                    <div class="event-name">{{ registration.event.title }}</div>
                    <div class="detail-rows">
                        <div class="detail-row">
                            <span class="detail-label">Category</span>
                            <span class="detail-val">{{ registration.event.category|title }}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Date</span>
                            <span class="detail-val">{{ registration.event.date }}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Venue</span>
                            <span class="detail-val">{{ registration.event.venue }}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Attendee</span>
                            <span class="detail-val">{{ registration.user.username }}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Pass Status</span>
                            <span class="detail-val">
                                <span class="status-valid">
                                    <div class="status-dot"></div>
                                    Valid
                                </span>
                            </span>
                        </div>
                    </div>
                </div>

            </div>

            <!-- Note -->
            <div class="qr-note">
                <span class="qr-note-icon">ⓘ</span>
                <span class="qr-note-text">
                    <strong>Note:</strong> Keep this QR pass safe. It is unique to your registration and used for event entry verification.
                </span>
            </div>

            <!-- Actions -->
            <div class="qr-actions">
                <a href="/my-events/" class="btn-back">← Back to My Events</a>
                <a href="/" class="btn-home">Home →</a>
            </div>

        </div>
    </div>
</div>

{% endblock %}